# Super Agent Dashboard - API Reference

**Version**: 1.0.0  
**Base URL**: `/api/trpc`  
**Authentication**: OAuth 2.0 (Session Cookie)

---

## Overview

The Super Agent Dashboard uses tRPC for type-safe API communication. All endpoints return JSON responses with the following structure:

```json
{
  "result": {
    "data": { /* response data */ }
  }
}
```

---

## Chat Router

### Create Chat Session

**Procedure**: `chat.createSession`  
**Method**: POST  
**Authentication**: Required

**Request**:
```typescript
{\n  modelUsed: string; // "kimi-k2" | "deepseek" | "qwen" | "minimax" | "gpt-4"\n  title?: string;    // Session name\n}\n```\n\n**Response**:\n```typescript\n{\n  sessionId: number;\n  userId: number;\n  modelUsed: string;\n  title: string;\n  messageCount: number;\n  totalTokensUsed: number;\n  totalCost: number;\n  createdAt: Date;\n}\n```\n\n**Example**:\n```typescript\nconst session = await trpc.chat.createSession.mutate({\n  modelUsed: 'kimi-k2',\n  title: 'Analysis Session'\n});\n```\n\n---\n\n### Send Message\n\n**Procedure**: `chat.sendMessage`  \n**Method**: POST  \n**Authentication**: Required\n\n**Request**:\n```typescript\n{\n  sessionId: number;      // Chat session ID\n  message: string;        // User message (1-10000 chars)\n  model: string;          // Model to use\n}\n```\n\n**Response**:\n```typescript\n{\n  response: string;       // AI response\n  tokensUsed: number;     // Tokens consumed\n  model: string;          // Model used\n  cost: number;           // Cost in USD\n  timestamp: Date;        // Response time\n}\n```\n\n**Example**:\n```typescript\nconst response = await trpc.chat.sendMessage.mutate({\n  sessionId: 1,\n  message: 'Analyze this data',\n  model: 'kimi-k2'\n});\n```\n\n---\n\n### Get Chat Messages\n\n**Procedure**: `chat.getMessages`  \n**Method**: GET  \n**Authentication**: Required\n\n**Request**:\n```typescript\n{\n  sessionId: number;      // Chat session ID\n  limit?: number;         // Max messages (default: 50)\n  offset?: number;        // Pagination offset (default: 0)\n}\n```\n\n**Response**:\n```typescript\nArray<{\n  id: number;\n  sessionId: number;\n  role: 'user' | 'assistant' | 'system';\n  content: string;\n  model: string;\n  tokensUsed: number;\n  cost: number;\n  createdAt: Date;\n}>\n```\n\n**Example**:\n```typescript\nconst messages = await trpc.chat.getMessages.query({\n  sessionId: 1,\n  limit: 50\n});\n```\n\n---\n\n### Get Chat Sessions\n\n**Procedure**: `chat.getSessions`  \n**Method**: GET  \n**Authentication**: Required\n\n**Response**:\n```typescript\nArray<{\n  id: number;\n  userId: number;\n  modelUsed: string;\n  title: string;\n  messageCount: number;\n  totalTokensUsed: number;\n  totalCost: number;\n  createdAt: Date;\n}>\n```\n\n**Example**:\n```typescript\nconst sessions = await trpc.chat.getSessions.query();\n```\n\n---\n\n### Get Available Models\n\n**Procedure**: `chat.getAvailableModels`  \n**Method**: GET  \n**Authentication**: Not required\n\n**Response**:\n```typescript\nArray<{\n  id: string;\n  name: string;\n  provider: string;\n  contextLength: number;\n  costPer1kTokens: number;\n  supportsVision: boolean;\n  supportsStreaming: boolean;\n  isAvailable: boolean;\n  totalUsageCount: number;\n  totalTokensUsed: number;\n  totalCost: number;\n  averageLatencyMs: number;\n}>\n```\n\n**Example**:\n```typescript\nconst models = await trpc.chat.getAvailableModels.query();\n```\n\n---\n\n## Agents Router\n\n### List Agents\n\n**Procedure**: `agents.list`  \n**Method**: GET  \n**Authentication**: Not required\n\n**Response**:\n```typescript\nArray<{\n  id: number;\n  name: string;\n  type: 'orchestrator' | 'executor' | 'analyzer';\n  status: 'idle' | 'busy' | 'error';\n  capabilities: string[];\n  tasksCompleted: number;\n  successRate: number;\n  lastActiveAt: Date;\n  averageLatencyMs: number;\n}>\n```\n\n**Example**:\n```typescript\nconst agents = await trpc.agents.list.query();\n```\n\n---\n\n### Get Agent by ID\n\n**Procedure**: `agents.getById`  \n**Method**: GET  \n**Authentication**: Not required\n\n**Request**:\n```typescript\n{\n  id: number;  // Agent ID\n}\n```\n\n**Response**:\n```typescript\n{\n  id: number;\n  name: string;\n  type: string;\n  status: string;\n  capabilities: string[];\n  tasksCompleted: number;\n  successRate: number;\n  lastActiveAt: Date;\n  averageLatencyMs: number;\n  metadata: Record<string, any>;\n}\n```\n\n**Example**:\n```typescript\nconst agent = await trpc.agents.getById.query({ id: 1 });\n```\n\n---\n\n### Get Agent Statistics\n\n**Procedure**: `agents.getStats`  \n**Method**: GET  \n**Authentication**: Not required\n\n**Response**:\n```typescript\n{\n  totalAgents: number;\n  activeAgents: number;\n  idleAgents: number;\n  errorAgents: number;\n  totalTasksCompleted: number;\n  averageSuccessRate: number;\n}\n```\n\n**Example**:\n```typescript\nconst stats = await trpc.agents.getStats.query();\n```\n\n---\n\n## Tasks Router\n\n### List Tasks\n\n**Procedure**: `tasks.list`  \n**Method**: GET  \n**Authentication**: Not required\n\n**Request**:\n```typescript\n{\n  limit?: number;         // Max tasks (default: 50)\n  offset?: number;        // Pagination offset (default: 0)\n  status?: string;        // Filter by status\n  agentId?: number;       // Filter by agent\n}\n```\n\n**Response**:\n```typescript\nArray<{\n  id: number;\n  agentId: number;\n  title: string;\n  description: string;\n  status: 'pending' | 'running' | 'completed' | 'failed' | 'cancelled';\n  priority: 'low' | 'medium' | 'high' | 'critical';\n  estimatedCost: number;\n  actualCost: number;\n  executionTimeMs: number;\n  result: string;\n  errorMessage: string | null;\n  createdAt: Date;\n  updatedAt: Date;\n}>\n```\n\n**Example**:\n```typescript\nconst tasks = await trpc.tasks.list.query({\n  status: 'running',\n  limit: 50\n});\n```\n\n---\n\n### Get Task Statistics\n\n**Procedure**: `tasks.getStats`  \n**Method**: GET  \n**Authentication**: Not required\n\n**Response**:\n```typescript\n{\n  total: number;\n  pending: number;\n  running: number;\n  completed: number;\n  failed: number;\n  cancelled: number;\n  totalCost: number;\n  averageExecutionTime: number;\n}\n```\n\n**Example**:\n```typescript\nconst stats = await trpc.tasks.getStats.query();\n```\n\n---\n\n## Metrics Router\n\n### Get Latest Metrics\n\n**Procedure**: `metrics.getLatest`  \n**Method**: GET  \n**Authentication**: Not required\n\n**Response**:\n```typescript\n{\n  timestamp: Date;\n  totalTasksCompleted: number;\n  totalTasksFailed: number;\n  successRate: number;\n  averageResponseTimeMs: number;\n  totalTokensUsed: number;\n  totalCostUSD: number;\n  activeAgents: number;\n  idleAgents: number;\n  errorAgents: number;\n  systemHealth: number; // 0-100\n}\n```\n\n**Example**:\n```typescript\nconst metrics = await trpc.metrics.getLatest.query();\n```\n\n---\n\n### Get Historical Metrics\n\n**Procedure**: `metrics.getHistory`  \n**Method**: GET  \n**Authentication**: Not required\n\n**Request**:\n```typescript\n{\n  hours?: number;  // Time range (default: 24)\n}\n```\n\n**Response**:\n```typescript\nArray<{\n  timestamp: Date;\n  totalTasksCompleted: number;\n  totalTasksFailed: number;\n  successRate: number;\n  averageResponseTimeMs: number;\n  totalTokensUsed: number;\n  totalCostUSD: number;\n  activeAgents: number;\n  systemHealth: number;\n}>\n```\n\n**Example**:\n```typescript\nconst history = await trpc.metrics.getHistory.query({ hours: 24 });\n```\n\n---\n\n### Get Model Metrics\n\n**Procedure**: `metrics.getModelMetrics`  \n**Method**: GET  \n**Authentication**: Not required\n\n**Response**:\n```typescript\nArray<{\n  modelId: string;\n  modelName: string;\n  usageCount: number;\n  totalTokensUsed: number;\n  totalCost: number;\n  averageLatencyMs: number;\n  successRate: number;\n}>\n```\n\n**Example**:\n```typescript\nconst modelMetrics = await trpc.metrics.getModelMetrics.query();\n```\n\n---\n\n### Get Cost Breakdown\n\n**Procedure**: `metrics.getCostBreakdown`  \n**Method**: GET  \n**Authentication**: Not required\n\n**Response**:\n```typescript\nArray<{\n  model: string;\n  usage: number;\n  cost: number;\n  percentage: number;\n}>\n```\n\n**Example**:\n```typescript\nconst costs = await trpc.metrics.getCostBreakdown.query();\n```\n\n---\n\n## Error Handling\n\nAll errors return the following format:\n\n```json\n{\n  "error": {\n    "code\": \"UNAUTHORIZED\",\n    \"message\": \"User not authenticated\"\n  }\n}\n```\n\n### Common Error Codes\n\n| Code | Status | Meaning |\n|------|--------|----------|\n| `UNAUTHORIZED` | 401 | Authentication required |\n| `FORBIDDEN` | 403 | Insufficient permissions |\n| `NOT_FOUND` | 404 | Resource not found |\n| `BAD_REQUEST` | 400 | Invalid input |\n| `INTERNAL_SERVER_ERROR` | 500 | Server error |\n| `RATE_LIMIT_EXCEEDED` | 429 | Too many requests |\n\n---\n\n## Rate Limiting\n\n- **Global**: 1000 requests/minute per user\n- **Chat**: 100 messages/hour per user\n- **Agents**: 1000 queries/hour per user\n- **Metrics**: 500 queries/hour per user\n\n**Headers**:\n```\nX-RateLimit-Limit: 1000\nX-RateLimit-Remaining: 999\nX-RateLimit-Reset: 1645000000\n```\n\n---\n\n## Pagination\n\nList endpoints support pagination:\n\n```typescript\n{\n  limit: 50,    // Items per page\n  offset: 0,    // Starting position\n  total: 1000,  // Total items\n  pages: 20     // Total pages\n}\n```\n\n---\n\n## References\n\n1. [tRPC Documentation](https://trpc.io)\n2. [REST API Best Practices](https://restfulapi.net/)\n3. [HTTP Status Codes](https://httpwg.org/specs/rfc7231.html#status.codes)\n\n---\n\n**Last Updated**: February 2026\n
